<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Portfolio de Arnaitz Penilla Ezcurra, Environment Artist especializado en Unreal Engine 5, iluminación y narrativa ambiental.">
    <title>Arnaitz Penilla | Environment Artist</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav>
      <a class="brand" href="index.html" aria-label="Ir a la página de inicio">
        <span class="brand-mark" aria-hidden="true">AP</span>
        <span class="brand-text">Arnaitz Penilla</span>
      </a>
      <div class="nav-links">
          <a href="index.html" class="active">Home</a>
          <a href="proyectos.html">Proyectos</a>
          <a href="about.html">About</a>
          <a href="contacto.html">Contacto</a>
      </div>
    </nav>

    <header class="hero" id="hero">
        <div class="hero-content" style="padding-left: 5%;">
            <h1>ENVIRONMENT ARTIST</h1>
            <p>Creando mundos inmersivos y narrativa ambiental.</p>
            <a href="proyectos.html" class="btn">Ver Portfolio</a>
        </div>
    </header>

    <script>
(function () {
  const hero = document.getElementById("hero");

  let images = [
    "Bosque_1.png",
    "Bosque_2.png",
    "Bosque_3.png",
    "Bosque_4.png",
    "Bosque_5.png",
    "Bosque_6.png",
    "Bosque_7.png",
    "Bosque_8.png",
    "Mina_abandonada_1.png",
    "Mina_abandonada_2.png",
    "Mina_abandonada_3.png",
    "Mina_abandonada_4.png",
    "Mina_abandonada_5.png",
    "Mina_abandonada_6.png"
  ];

  const intervalMs = 5000;
  const fadeMs = 1200;

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  // Carga una imagen y resuelve cuando está lista (o rechaza si falla)
  function loadImage(src) {
    return new Promise((resolve, reject) => {
      const img = new Image();
      img.onload = () => resolve(src);
      img.onerror = () => reject(new Error("No se pudo cargar: " + src));
      img.src = src;
    });
  }

  // Intentar obtener la siguiente imagen válida (saltando las que fallen)
  async function getNextValidImage(startIndex) {
    let tries = 0;
    let i = startIndex;

    while (tries < images.length) {
      const candidate = images[i];
      try {
        await loadImage(candidate);
        return { src: candidate, index: i };
      } catch (e) {
        console.warn(e.message);
        // saltar imagen rota
        i = (i + 1) % images.length;
        tries++;
      }
    }

    // Si TODAS fallan, devolvemos null y no cambiamos nada
    return null;
  }

  shuffle(images);

  let index = 0;
  let showingA = true;

  hero.style.setProperty("--fade-ms", `${fadeMs}ms`);

  // Inicializa con 2 imágenes ya cargadas (si alguna falla, la salta)
  (async function init() {
    const first = await getNextValidImage(0);
    if (!first) return;

    const second = await getNextValidImage((first.index + 1) % images.length);

    hero.style.setProperty("--bg-a", `url('${first.src}')`);
    hero.classList.add("show-a");

    if (second) {
      hero.style.setProperty("--bg-b", `url('${second.src}')`);
      index = second.index;
    } else {
      index = first.index;
    }

    setInterval(async () => {
      const nextStart = (index + 1) % images.length;
      const nextObj = await getNextValidImage(nextStart);
      if (!nextObj) return;

      const next = nextObj.src;
      index = nextObj.index;

      if (showingA) {
        hero.style.setProperty("--bg-b", `url('${next}')`);
        hero.classList.remove("show-a");
        hero.classList.add("show-b");
      } else {
        hero.style.setProperty("--bg-a", `url('${next}')`);
        hero.classList.remove("show-b");
        hero.classList.add("show-a");
      }

      showingA = !showingA;
    }, intervalMs);
  })();
})();
</script>

</body>
</html>

